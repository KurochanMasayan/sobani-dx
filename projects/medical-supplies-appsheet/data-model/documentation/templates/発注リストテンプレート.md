# 発注リストPDFテンプレート

## Google Docsテンプレートの作成手順

### 1. テンプレートファイル名
`発注リスト_Template.docx`

### 2. テンプレート構造

```
=====================================
        発注対象商品リスト
        作成日: <<TODAY()>>
=====================================

発注必要商品: <<COUNT(SELECT(商品マスタ[商品ID], [発注対象フラグ] = TRUE))>>件

<<Start: SELECT(商品マスタ[商品ID], [発注対象フラグ] = TRUE)>>
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
商品コード: <<[商品ID]>>
商品名: <<[商品名]>>
JAN: <<[JANコード]>>
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

現在在庫: <<[現在在庫個数]>> 個
定数在庫: <<[定数在庫_個数]>> 個
不足数量: <<[定数在庫_個数] - [現在在庫個数]>> 個

推奨発注数:
  箱数: <<CEILING(([定数在庫_個数] - [現在在庫個数]) / [箱入数_個数])>> 箱
  個数: <<CEILING(([定数在庫_個数] - [現在在庫個数]) / [箱入数_個数]) * [箱入数_個数]>> 個

単価（箱）: ¥<<TEXT([単価_箱], "#,##0")>>
発注金額: ¥<<TEXT(CEILING(([定数在庫_個数] - [現在在庫個数]) / [箱入数_個数]) * [単価_箱], "#,##0")>>

<<End>>

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
合計発注金額: ¥<<TEXT(SUM(SELECT(商品マスタ[単価_箱] * CEILING(([定数在庫_個数] - [現在在庫個数]) / [箱入数_個数]), [発注対象フラグ] = TRUE)), "#,##0")>>
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 3. 変数説明
- `<<Start: ... >>` `<<End>>`: 繰り返し処理
- `<<[カラム名]>>`: データ置換
- `<<式>>`: 計算式実行

### 4. AppSheetでの設定

#### Bot設定
```yaml
Bot Name: 発注リストPDF出力
Event:
  Type: Scheduled
  Schedule: Daily at 9:00 AM
  Condition: COUNT(SELECT(商品マスタ[商品ID], [発注対象フラグ] = TRUE)) > 0

Process:
  - Create PDF from Template
    Template: 発注リスト_Template.docx
    Save to: /発注リスト/
    Filename: CONCATENATE("発注リスト_", TEXT(TODAY(), "YYYY-MM-DD"), ".pdf")
```