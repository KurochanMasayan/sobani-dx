# 歯科診療スケジュール管理システム 要件定義書

## 1. システムの必要性

### 1.1 背景
- 歯科は医科と異なり、訪問回数が治療内容により大きく変動する
  - 入れ歯作成時は毎週訪問
  - 破損対応で連続訪問 など
- 定期訪問（2週間ごと）が基本だが、イレギュラー対応で予定変更が頻繁に発生
- スケジュール変更作業の簡易化が必要

### 1.2 現状の課題
- 2つのシート（診療スケジュール・タイムスケジュール）を別々に管理しており、**二重入力が発生**
- 歯科用デジタルレセコンはクラウド非対応のため、Googleスプレッドシートでの管理が最適

---

## 2. 主要機能要件

### 2.1 患者マスター管理

| 要件ID | 要件 | 優先度 |
|--------|------|--------|
| PM-01 | 患者一覧を一元管理し、歯科診療スケジュールと連携 | 必須 |
| PM-02 | 必要項目を選択して印刷できる機能（例：要介護度は必要だが介護負担割合は不要） | 必須 |
| PM-03 | 項目の列フィルター機能 | 要検討 |

### 2.2 スケジュール管理

| 要件ID | 要件 | 優先度 |
|--------|------|--------|
| SC-01 | 患者名入力で施設情報が自動表示 | 必須 |
| SC-02 | 訪問回数の自動カウント | 必須 |
| SC-03 | 時間調整は手動入力または選択式 | 必須 |

### 2.3 居宅療養管理指導の算定管理

| 要件ID | 要件 | 優先度 |
|--------|------|--------|
| BL-01 | 歯科医師：月2回まで算定可能 | 必須 |
| BL-02 | 歯科衛生士：月4回まで算定可能、かつ20分以上の滞在が必須 | 必須 |
| BL-03 | 訪問が月に5-6回あっても算定できるのは上限回数まで | 必須 |
| BL-04 | どの訪問日で算定するか一目で管理できる機能 | 必須 |
| BL-05 | 歯科衛生士の場合は、衛生士の動きと患者の動きの二軸管理が必要（20分要件のため物理的に取れない場合あり） | 必須 |

#### 算定ルール詳細

```
【歯科医師】
- 月2回まで算定可能
- 訪問回数 > 2回 の場合、どの訪問日で算定するか選択が必要

【歯科衛生士】
- 月4回まで算定可能
- 1回あたり20分以上の滞在が必須
- 衛生士のスケジュールと患者の都合の両方を考慮する必要あり
```

---

## 3. システム構成案

```
┌─────────────────────────────────────────────────────────┐
│                    AppSheet                            │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │
│  │ 患者マスタ   │  │ スケジュール │  │  算定管理   │    │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘    │
└─────────┼────────────────┼────────────────┼───────────┘
          │                │                │
          ▼                ▼                ▼
┌─────────────────────────────────────────────────────────┐
│              Google スプレッドシート                     │
│  （歯科用デジタルレセコンがクラウド非対応のため）          │
└─────────────────────────────────────────────────────────┘
          │
          ▼
┌─────────────────────────────────────────────────────────┐
│         Google Apps Script (GAS)                        │
│  （AppSheetオートメーションから呼び出し、必要に応じて拡張）│
└─────────────────────────────────────────────────────────┘
```

---

## 4. データモデル（暫定）

### マスタテーブル
- 施設マスタ（FAC001〜）
- 患者マスタ（施設ID参照）
- 居宅介護支援事業所マスタ（CMP001〜）

### トランザクションテーブル（今後設計）
- 診療スケジュール
- 算定管理

---

## 5. 今後の検討事項

- [ ] 項目の列フィルター機能の実装可否
- [ ] 算定管理画面のUI設計
- [ ] 歯科衛生士の二軸管理（衛生士×患者）の具体的な実装方法
